<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        <meta name="author" content="Daniel Schwalbe">
        <link rel="canonical" href="https://info314.giantfirewall.com/resources/vlans-and-dummies/">
        <link rel="shortcut icon" href="../../img/favicon.ico">
        <title>Configuring VLANs and Dummy Interfaces in Networkd - INFO 314 Course Resources</title>
        <link href="../../css/bootstrap.min.css" rel="stylesheet">
        <link href="../../css/font-awesome.min.css" rel="stylesheet">
        <link href="../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/color-brewer.min.css">

        <script src="../../js/jquery-1.10.2.min.js" defer></script>
        <script src="../../js/bootstrap.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="../..">INFO 314 Course Resources</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbar-collapse">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="navitem">
                                <a href="../.." class="nav-link">Home</a>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Projects <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">1 - Pi Setup</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../assignments/pi-setup/" class="dropdown-item">Raspberry Pi Setup</a>
</li>
            
<li>
    <a href="../../assignments/networkd-setup/" class="dropdown-item">networkd Setup</a>
</li>
            
<li>
    <a href="../wifi-reference/" class="dropdown-item">Wifi Reference</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">2 - Set up a DHCP Server</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../assignments/dhcp-setup/" class="dropdown-item">Installing and Configuring the ISC DHCP Server</a>
</li>
    </ul>
  </li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Labs <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../assignments/lab1/" class="dropdown-item">Lab 1 - Core Technical Skills</a>
</li>
                                    
<li>
    <a href="../../assignments/lab2/" class="dropdown-item">Lab 2 - Analyze DNS & HTTP in Wireshark</a>
</li>
                                    
<li>
    <a href="../../assignments/lab3/" class="dropdown-item">Lab 3 - Analyzing DHCP and ARP with Wireshark</a>
</li>
                                    
<li>
    <a href="../../assignments/lab4/" class="dropdown-item">Lab 4 - Analyze Zeroconf in Wireshark</a>
</li>
                                    
<li>
    <a href="../../assignments/lab5/" class="dropdown-item">Lab 5 - Analyze TCP with ncat and Wireshark</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Resources <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">Concepts and Theory</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../notes/dns-overview/" class="dropdown-item">Domain Name System (DNS)</a>
</li>
            
<li>
    <a href="../../notes/router-overview/" class="dropdown-item">Routers</a>
</li>
            
<li>
    <a href="../../notes/ethernet-switches/" class="dropdown-item">Ethernet Switches</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">Guides</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../pi-materials/" class="dropdown-item">Getting Pi Materials</a>
</li>
            
<li>
    <a href="../digital-ocean/" class="dropdown-item">Digital Ocean Signup</a>
</li>
            
<li>
    <a href="../address-planning/" class="dropdown-item">Basic IP Address Planning</a>
</li>
            
<li>
    <a href="../wifi-reference/" class="dropdown-item">Linux Wireless Configuration</a>
</li>
            
<li>
    <a href="../ssh-agent/" class="dropdown-item">Using ssh-agent</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">Quick Reference</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../markdown/" class="dropdown-item">Intro to Markdown</a>
</li>
            
<li>
    <a href="../bash/" class="dropdown-item">Intro to Bash</a>
</li>
            
<li>
    <a href="../host-config/" class="dropdown-item">Mac/Win/Linux Networking</a>
</li>
            
<li>
    <a href="../wireshark-install/" class="dropdown-item">Install Wireshark</a>
</li>
            
<li>
    <a href="../tshark-install/" class="dropdown-item">Install TShark</a>
</li>
            
<li>
    <a href="../manage-dhcp/" class="dropdown-item">Troubleshooting DHCP</a>
</li>
            
<li>
    <a href="../dns-clients/" class="dropdown-item">Managing DNS Clients</a>
</li>
    </ul>
  </li>
                                </ul>
                            </li>
                            <li class="navitem">
                                <a href="../../contact/" class="nav-link">Contact Us</a>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ml-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li class="nav-item">
                                <a href="https://github.com/info314/website" class="nav-link">info314/website</a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-light navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-toggle="collapse" data-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-secondary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-level="1"><a href="#configuring-vlans-and-dummy-interfaces-in-networkd" class="nav-link">Configuring VLANs and Dummy Interfaces in Networkd</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="2"><a href="#vlans" class="nav-link">VLANs</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#dummy-interfaces" class="nav-link">Dummy Interfaces</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#resources" class="nav-link">Resources</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<h1 id="configuring-vlans-and-dummy-interfaces-in-networkd">Configuring VLANs and Dummy Interfaces in Networkd<a class="headerlink" href="#configuring-vlans-and-dummy-interfaces-in-networkd" title="Permanent link">&para;</a></h1>
<h2 id="vlans">VLANs<a class="headerlink" href="#vlans" title="Permanent link">&para;</a></h2>
<p>VLAN functionality in networkd enables Linux hosts to participate in VLANs based on explicit tagging of ethernet frames. VLANs provide a valuable layer of logical configurability on top of physical network infrastructure. VLAN connections are presented in Linux as software-defined network interfaces that can be configured and utilized just like other types of network interfaces.</p>
<h3 id="creating-vlan-interfaces">Creating VLAN Interfaces<a class="headerlink" href="#creating-vlan-interfaces" title="Permanent link">&para;</a></h3>
<p>Networkd supports various software-defined interface types that are created based on <code>.netdev</code> files in the networkd configuration directories. A <code>.netdev</code> for a VLAN sets <code>Kind=vlan</code> and defines the numeric ID used to tag VLAN traffic on the wire in order to keep it separate from other traffic. </p>
<div class="admonition example">
<p class="admonition-title">Creating a VLAN interface</p>
<p><strong><code>/etc/systemd/network/15-vlan25.netdev</code></strong></p>
<pre class="highlight"><code>[NetDev]
Name=vlan25
Kind=vlan

[VLAN]
# Specify the tag
Id=25</code></pre>
</div>
<h3 id="add-vlans-to-a-physical-interface">Add VLANs to a Physical Interface<a class="headerlink" href="#add-vlans-to-a-physical-interface" title="Permanent link">&para;</a></h3>
<p>In order to send and receive tagged traffic over a network link, we need to associate the newly created VLAN interfaces with the physical LAN interface. In networkd, this can be done by adding one or more VLAN properties to the physical interface's <code>.network</code> configuration. After doing this, tagged frames will be presented to the operating system as originating from the associated VLAN interface. Likewise, traffic that is sent through a VLAN interface will be tagged with the specified ID before being sent on the network.</p>
<div class="admonition example">
<p class="admonition-title">Linking a VLAN interface to a physical interface</p>
<p><strong><code>/etc/systemd/network/20-eth0.network</code></strong>
<pre class="highlight"><code>[Match]
Name=eth0

[Network]
# Existing Configuration
Address=192.168.0.1/24

# Tagged VLANs Referenced by Interface Name
VLAN=vlan25
VLAN=vlan50</code></pre></p>
</div>
<h3 id="network-configuration-for-vlan-interfaces">Network Configuration for VLAN Interfaces<a class="headerlink" href="#network-configuration-for-vlan-interfaces" title="Permanent link">&para;</a></h3>
<p>Attaching the VLANs to a physical interface enables traffic to be sent and received from the virtual interface via tagged frames on the physical link. At the moment, however, our VLAN interfaces do not have any network-level settings attached to them.</p>
<p>Depending on the task at hand and the configuration of the Linux host, you may configure the new interfaces by any method(s) available, including networkd:</p>
<div class="admonition example">
<p class="admonition-title">Sample VLAN interface configuration</p>
<p><strong><code>/etc/systemd/network/25-vlan25.network</code></strong></p>
<p>``` tab="DHCP"
[Match]
Name=vlan25</p>
<p>[Network]
DHCP=ipv4
<pre class="highlight"><code>
``` tab="Static IP"
[Match]
Name=vlan25

[Network]
Address=172.16.0.1/24
DNS=1.1.1.1</code></pre></p>
</div>
<h2 id="dummy-interfaces">Dummy Interfaces<a class="headerlink" href="#dummy-interfaces" title="Permanent link">&para;</a></h2>
<p>When we set up labs with multiple services hosted on a single physical node, it can be useful to virtualize additional network connections and interfaces to allow us to extend the logical topology of the system. Dummy interfaces are treated much like standard network interfaces, although they do not require a physical connection and do not go up and down based on link status. Like a standard ethernet interface, a dummy interface can be configured with an IP address and other layer-3 settings. Likewise, we can bind daemons to sockets on our dummy interfaces and respond to network requests received at these addresses. </p>
<h3 id="creating-the-interface">Creating the Interface<a class="headerlink" href="#creating-the-interface" title="Permanent link">&para;</a></h3>
<p>Adding a .netdev definition with <code>Kind=dummy</code> will trigger networkd to add a dummy interface and make it visible to other standard networking tools.</p>
<div class="admonition example">
<p class="admonition-title">Creating a Dummy Interface</p>
<p><strong><code>/etc/systemd/network/10-dmz0.netdev</code></strong>
<pre class="highlight"><code>[NetDev]
Name=dmz0
Kind=dummy</code></pre></p>
</div>
<h2 id="resources">Resources<a class="headerlink" href="#resources" title="Permanent link">&para;</a></h2>
<ul>
<li><a href="https://wiki.archlinux.org/index.php/VLAN">https://wiki.archlinux.org/index.php/VLAN</a></li>
<li><a href="https://manpages.debian.org/stretch/systemd/systemd.netdev.5.en.html">https://manpages.debian.org/stretch/systemd/systemd.netdev.5.en.html</a></li>
<li><a href="https://wiki.archlinux.org/index.php/systemd-networkd">https://wiki.archlinux.org/index.php/systemd-networkd</a></li>
</ul></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
                <p>Copyright &copy; 2020 Daniel Schwalbe</p>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>
            var base_url = "../..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../../js/base.js" defer></script>
        <script src="../../search/main.js" defer></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
