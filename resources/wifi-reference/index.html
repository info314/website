<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        <meta name="author" content="Daniel Schwalbe">
        <link rel="canonical" href="https://info314.giantfirewall.com/resources/wifi-reference/">
        <link rel="shortcut icon" href="../../img/favicon.ico">
        <title>Wifi Reference - INFO 314 Course Resources</title>
        <link href="../../css/bootstrap.min.css" rel="stylesheet">
        <link href="../../css/font-awesome.min.css" rel="stylesheet">
        <link href="../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/color-brewer.min.css">

        <script src="../../js/jquery-1.10.2.min.js" defer></script>
        <script src="../../js/bootstrap.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="../..">INFO 314 Course Resources</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbar-collapse">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="navitem">
                                <a href="../.." class="nav-link">Home</a>
                            </li>
                            <li class="dropdown active">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Projects <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">1 - Pi Setup</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../assignments/pi-setup/" class="dropdown-item">Raspberry Pi Setup</a>
</li>
            
<li>
    <a href="../../assignments/networkd-setup/" class="dropdown-item">networkd Setup</a>
</li>
            
<li>
    <a href="./" class="dropdown-item active">Wifi Reference</a>
</li>
    </ul>
  </li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Labs <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../assignments/lab1/" class="dropdown-item">Lab 1 - Core Technical Skills</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Resources <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">Guides</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../pi-materials/" class="dropdown-item">Getting Pi Materials</a>
</li>
            
<li>
    <a href="../digital-ocean/" class="dropdown-item">Digital Ocean Signup</a>
</li>
            
<li>
    <a href="../address-planning/" class="dropdown-item">Basic IP Address Planning</a>
</li>
            
<li>
    <a href="../ssh-agent/" class="dropdown-item">Using ssh-agent</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">Quick Reference</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../markdown/" class="dropdown-item">Intro to Markdown</a>
</li>
            
<li>
    <a href="../bash/" class="dropdown-item">Intro to Bash</a>
</li>
            
<li>
    <a href="../host-config/" class="dropdown-item">Mac/Win/Linux Networking</a>
</li>
            
<li>
    <a href="../wireshark-install/" class="dropdown-item">Install Wireshark</a>
</li>
            
<li>
    <a href="../tshark-install/" class="dropdown-item">Install TShark</a>
</li>
            
<li>
    <a href="../manage-dhcp/" class="dropdown-item">Troubleshooting DHCP</a>
</li>
            
<li>
    <a href="../dns-clients/" class="dropdown-item">Managing DNS Clients</a>
</li>
    </ul>
  </li>
                                </ul>
                            </li>
                            <li class="navitem">
                                <a href="../../contact/" class="nav-link">Contact Us</a>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ml-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li class="nav-item">
                                <a rel="prev" href="../../assignments/networkd-setup/" class="nav-link">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li class="nav-item">
                                <a rel="next" href="../../assignments/lab1/" class="nav-link">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                            <li class="nav-item">
                                <a href="https://github.com/info314/website" class="nav-link">info314/website</a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-light navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-toggle="collapse" data-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-secondary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-level="1"><a href="#wpa-supplicant-configuration-reference-2020-01-18" class="nav-link">WPA Supplicant Configuration Reference (2020-01-18)</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="2"><a href="#basic-configuration" class="nav-link">Basic Configuration</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#unencrypted-networks" class="nav-link">Unencrypted Networks</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#wpa2-personal-networks" class="nav-link">WPA2 Personal Networks</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#wpa2-enterprise-networks" class="nav-link">WPA2 Enterprise Networks</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#using-university-of-washington-instead-of-eduroam" class="nav-link">Using "University of Washington" instead of "eduroam"</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#applying-configuration-changes" class="nav-link">Applying Configuration Changes</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<h1 id="wpa-supplicant-configuration-reference-2020-01-18">WPA Supplicant Configuration Reference (2020-01-18)<a class="headerlink" href="#wpa-supplicant-configuration-reference-2020-01-18" title="Permanent link">&para;</a></h1>
<h2 id="basic-configuration">Basic Configuration<a class="headerlink" href="#basic-configuration" title="Permanent link">&para;</a></h2>
<p>Wireless settings for the Pi are controlled by a service called <strong>wpa_supplicant</strong>, which stores information about known wireless networks in a text-based configuration file in <strong><code>/etc/wpa_supplicant/</code></strong>. By default, in Raspbian, the name of this file is <strong><code>wpa_supplicant.conf</code></strong>. You may also encounter an interface-specific configuration where the interface name is appended to the file, e.g., <strong><code>wpa_supplicant-wlan0.conf</code></strong>. In both cases, the file is owned by <strong>root</strong> and requires <strong>root</strong> privileges to read or edit.</p>
<details class="danger"><summary>Security Risk</summary><p><strong><code>wpa_supplicant.conf</code></strong> is protected from casual reading due to the fact that it is a sensitive file that will likely contain your home network keys and a hash of your UW NetID password. While hashes typically provide some extra protection of a stored password, MD4 is nearly useless in this regard except with really strong passwords.</p>
<p>Practice caution with this file:</p>
<ol>
<li>Never share the contents of this file directly online.</li>
<li>Scrub passwords, keys, and hashes before committing a copy into a <strong>repository</strong>.</li>
<li>Reset your password if you lose your Pi or suspect that you may have disclosed it inadvertently.</li>
</ol>
</details>
<p>You can edit <strong>wpa_supplicant</strong> configs directly on the Pi using any terminal-based text editor. Alternatively, you can create the file on your local system and copy it into place on the Pi (as described later in this guide). </p>
<details class="warning"><summary>Warning: Windows line-endings and rich text format</summary><p>As students get started with Linux networking, we frequently encounter problems related to the overall file format. As a rule, the configuration files you create in this class must be plain text with standard line endings. </p>
<p>You'll want to stick to using a code-oriented text editor, as opposed to options like macOS TextEdit and Windows Notepad that often save files as <em>rich text</em> rather than plain text.</p>
<p>For Windows users, a code-oriented editor will also help you avoid issues related to line endings. While most operating systems use a simple <em>New Line (aka Line Feed)</em> control character to signify the end of a line, most Windows tools also include a <em>Carriage Return</em>. This alternate line ending causes parsing errors in many Linux tools.</p>
</details>
<p>The general structure of the configuration file is show below. The file begins with a standard set of parameters specifying the <strong>country</strong> (needed to initialize appropriate radio settings), a <strong>control interface</strong> used by network management tools, and a boolean that instructs <strong>wpa_supplicant</strong> to accept configuration updates from other network management tools. We won't delve any deeper into the meaning of these initial parameters within this course. Rather, our concern will be how to configure Linux to join nearby wireless networks.</p>
<div class="admonition example">
<p class="admonition-title">Example <code>wpa_supplicant.conf</code></p>
<pre class="highlight"><code>country=US
ctrl_interface=DIR=/var/run/wpa_supplicant GROUP=netdev
update_config=1

network={
    ssid="Some public network"
    key_mgmt=NONE
}

network={
    ssid="My home network"
    psk="Don't tell anyone the password"
}</code></pre>
</div>
<p>The contents of the network block will depend largely on the security settings of the network, e.g., whether or not the network is encrypted with a passphrase. This document provides instructions for configuring three common types of networks: </p>
<ol>
<li>Unencrypted Networks</li>
<li>WPA2 Personal Networks (simple passphrase)</li>
<li>WPA2 Enterprise Networks</li>
</ol>
<p>Let's start by examining the configuration for an unencrypted network.</p>
<h2 id="unencrypted-networks">Unencrypted Networks<a class="headerlink" href="#unencrypted-networks" title="Permanent link">&para;</a></h2>
<p>All networks are defined by <code>parameter=value</code> pairs enclosed within <code>network={}</code>. Regardless of security configuration, each network block is required to contain an <strong><code>ssid</code></strong> parameter identifying the network. The <strong>service set identifier (SSID)</strong> is the network name that you see on your device when you connect to a wireless network. Since this name may include whitespace, we encapsulate it in double quotes.</p>
<p>In addition to the <strong>ssid</strong>, <strong>wpa_supplicant</strong> expects us to provide encryption a passphrase and other encryption settings for the wireless network. Omitting these settings, even for an unencrypted network, will result in errors. </p>
<p>Instead, for unencrypted networks, we explicitly disable encryption with <strong><code>key_mgmt=NONE</code></strong>.</p>
<div class="admonition example">
<p class="admonition-title">Configuration for an unencrypted network</p>
<pre class="highlight"><code>network={
    ssid="Coffee Shop"
    key_mgmt=NONE
}</code></pre>
</div>
<h2 id="wpa2-personal-networks">WPA2 Personal Networks<a class="headerlink" href="#wpa2-personal-networks" title="Permanent link">&para;</a></h2>
<p>For a basic (non-enterprise) encrypted network, the configuration of the network block changes only slightly. Rather than specify the <code>key_mgmt</code> setting, we assign the network passphrase to the <code>psk</code> parameter.</p>
<p>There are two ways to accomplish this task. First, we can assign the passphrase directly to the parameter in plaintext as shown here:</p>
<div class="admonition danger">
<p class="admonition-title">Danger: Don't do this!!!</p>
<pre class="highlight"><code>network={
    ssid="Home Wifi"
    psk="super secret squirrels"
}</code></pre>
</div>
<p>Security professionals generally frown on plaintext passwords and passphrases being written to configuration files or code. As such, we prefer to write the configuration based on the raw network key (computed using a function called <em>PBKDF</em> in conjunction with <em>SHA1</em>).</p>
<div class="admonition faq">
<p class="admonition-title">Using <code>wpa_passphrase</code> to generate a raw PSK</p>
<p>You can generate the raw psk directly on your Pi by running the <code>wpa_passphrase</code> utility. This utility takes your SSID as an argument and then prompts you to enter your passphrase. </p>
<pre class="highlight"><code class="language-bash"># Pass your SSID as the first argument
wpa_passphrase "Home Wifi"</code></pre>
<p>You will not see any characters or placeholders echoed as you type the passphrase, but <strong><code>wpa_passphrase</code></strong> will continue to accept input until you hit <em>Enter/Return</em>. The output will be a valid <strong>wpa_supplicant</strong> configuration that you can paste into your configuration.</p>
<pre class="highlight"><code>network={
    ssid="Home Wifi"
    psk=2508539ff867a3578f6ba7d9ee1d4a62aea82c25d30ffb1eb3a05cd08a373c02
}</code></pre>
</div>
<h2 id="wpa2-enterprise-networks">WPA2 Enterprise Networks<a class="headerlink" href="#wpa2-enterprise-networks" title="Permanent link">&para;</a></h2>
<p>Unlike home and coffee shop networks, enterprise networks like <em>Eduroam</em>, require a bit more setup since they authenticate individual users to the network as part of the process of establishing an encrypted connection. As such, these networks are substantially more secure than networks that are protected by <strong>WPA2 Personal</strong>. </p>
<p><em>Eduroam</em> at UW uses the NetID system to authenticate users and grant secure access to the network. Before you can join the network, you will first need to compute a hash from your NetID password. For security and privacy purposes, you will use this hash as a substitute for your password within the final configuration.</p>
<div class="admonition instructions">
<p class="admonition-title">Computing an MD4 hash in Linux</p>
<p>Follow these commands in order to compute the MD4 hash in Linux.<sup id="fnref:shellscript"><a class="footnote-ref" href="#fn:shellscript">1</a></sup> The <em>history</em> commands are not needed to compute a hash but are added for security. Without them, your password will be stored in the Bash history file and easily readable to anyone with access to your memory card.</p>
<pre class="highlight"><code class="language-bash">set +o history

echo -n 'This is your password' | iconv -t utf16le | openssl md4
# You should see output like 6f9bad2c90b80bd549e595fc91e27806

set -o history</code></pre>
</div>
<p>The following template supplies all of the parameters needed to attach to Eduroam at UW. Add it to your <strong><code>wpa_supplicant.conf</code></strong>, substituting your own NetID and password hash for the supplied values.</p>
<div class="admonition info">
<p class="admonition-title">Eduroam configuration template</p>
<pre class="highlight"><code>network={
        ssid="eduroam"
        scan_ssid=1
        key_mgmt=WPA-EAP
        eap=PEAP
        identity="YOUR_NETID@uw.edu"
        password=hash:6f9bad2c90b80bd549e595fc91e27806
        phase1="peaplabel=0"
        phase2="auth=MSCHAPV2"
}</code></pre>
</div>
<h2 id="using-university-of-washington-instead-of-eduroam">Using "University of Washington" instead of "eduroam"<a class="headerlink" href="#using-university-of-washington-instead-of-eduroam" title="Permanent link">&para;</a></h2>
<p>If eduoroam does not work for you, please let us know. <strong>If you are given explicit instructions to connect "University of Washington" WiFi instead, then use these instructions.</strong></p>
<p><strong>DO NOT connect to "University of Washington" without explicit permission for us</strong></p>
<p><strong>Please setup your Pi for connecting to eduroam, but follow this guide if that does not work.</strong></p>
<p>To set "University of Washington" up, do as follows:</p>
<p>Find the MAC address of <code>wlan0</code> on your pi using the <code>ip link</code> command.</p>
<p><strong>Make sure to select the MAC of <code>wlan0</code> and not <code>eth0</code>!</strong></p>
<p><img alt="" src="../../img/uofw1.png" /></p>
<p>Register your <code>wlan0</code> MAC address manually for UW WiFi at:
<a href="https://itconnect.uw.edu/connect/uw-networks/campus-wi-fi/manual-wifi-reg/">https://itconnect.uw.edu/connect/uw-networks/campus-wi-fi/manual-wifi-reg/</a></p>
<p><img alt="" src="../../img/uofw2fixed.png" /></p>
<p><img alt="" src="../../img/uofw3.png" /></p>
<p>Next, edit <code>wpa_supplicant.conf</code> again using:
<code>sudo nano /etc/wpa_supplicant/wpa_supplicant.conf</code>
or <code>sudo nano /etc/wpa_supplicant/wpa_supplicant-wlan0.conf</code>
depending on where you are in the setup of your Pi.</p>
<p>Add the “University of Washington” network.</p>
<p>Put this definition above <code>eduroam</code> in your <code>wpa_supplicant.conf</code> file so that it will take priority.</p>
<p>Also, add <code>disabled=1</code> on a line in the <code>eduroam</code> section.</p>
<p><img alt="" src="../../img/uofw4.png" /></p>
<h2 id="applying-configuration-changes">Applying Configuration Changes<a class="headerlink" href="#applying-configuration-changes" title="Permanent link">&para;</a></h2>
<p>Like other services, <strong>wpa_supplicant</strong> will not load our changes automatically. Rather than reset the daemon completely using <strong><code>systemctl</code></strong>, we can use <strong><code>wpa_cli</code></strong> to update the configuration and perform other basic maintenance.</p>
<p>When running <strong><code>wpa_cli</code></strong> we need to specify the interface we are configuring and a command to send to the <strong>wpa_supplicant</strong> service.</p>
<div class="admonition instructions">
<p class="admonition-title">Load configuration from <code>wpa_supplicant.conf</code></p>
<pre class="highlight"><code># Update configuration from disk
wpa_cli -i wlan0 reconfigure

# Check the status of current connection
wpa_cli -i wlan0 status</code></pre>
</div>
<p>See <strong><code>man wpa_cli</code></strong> for further instructions and examples.</p>
<div class="footnote">
<hr />
<ol>
<li id="fn:shellscript">
<p>The project repository includes a shell script called <strong>calc-md4-hash.sh</strong> that will compute this value for you. It can be run from macOS, Linux, and Git Bash (Windows users). To run the script, navigate to the resources path in your git repository and type <code>./calc-md4-hash.sh</code>. You may also copy this file to your Pi and run it there.&#160;<a class="footnote-backref" href="#fnref:shellscript" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
</ol>
</div></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
                <p>Copyright &copy; 2020 Daniel Schwalbe</p>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>
            var base_url = "../..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../../js/base.js" defer></script>
        <script src="../../search/main.js" defer></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
